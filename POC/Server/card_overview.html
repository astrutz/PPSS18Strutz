<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Card Overview</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
<div class="container">
    <div class="cardOverview">
        <h1 class="custom-headline">Übersicht der verwendeten Karten</h1>
    </div>
    <div class="row" id="assign">
        <div class="col-4">
            <input id="storyAbbreviation" type="text" placeholder="Story-ID">
        </div>
        <div class="col-4">
            <button onclick="assignCard('')" type="button" class="btn btn-primary">Story einer Karte zuweisen</button>
        </div>
    </div>
    <div class="row" id="deassign">
        <div class="col-4">
            <input id="cardId" type="text" placeholder="Karten-ID">
        </div>
        <div class="col-4">
            <button onclick="assignCard('de')" type="button" class="btn btn-danger">Story von Karte lösen</button>
        </div>
    </div>
</div>
</body>
<script>
    function moveAccordion(element) {
        if ($("#content" + element).is(":visible")) {
            $("#card" + element).css("background-color", "#ffffff");
            $("#content" + element).css("display", "none");
            $("#accordionIcon" + element).attr("src", "/img/baseline-keyboard_arrow_down-24px.svg");
        } else {
            $("#card" + element).css("background-color", "#f5f5f5");
            $("#content" + element).css("display", "block");
            $("#accordionIcon" + element).attr("src", "/img/baseline-keyboard_arrow_up-24px.svg");
        }
    }

    function assignCard(prefix) {
        let abbreviation = '';
        if (prefix !== '') {
            abbreviation = $('#cardId').val();
        } else {
            abbreviation = $('#storyAbbreviation').val();
        }
        let request = new XMLHttpRequest();
        request.open("GET", "/card/" + prefix + "assign/" + abbreviation);
        request.addEventListener('load', function (event) {
            if (request.status >= 200 && request.status < 300) {
                if (request.responseText != null) {
                    $('#deassign').append('<div class="alert alert-success" role="alert">' + 'Aktion wurde erfolgreich durchgeführt!' + '</div>');
                } else {
                    $('#deassign').append('<div class="alert alert-danger" role="alert">' + 'Aktion konnte nicht durchgeführt werden!' + '</div>');

                }
            } else {
                console.warn(request.statusText, request.responseText);
            }
        });
        request.send();
    }
</script>
</html>